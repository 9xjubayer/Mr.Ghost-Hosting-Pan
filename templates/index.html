<!DOCTYPE html>
<html lang="bn">
<head>
    <title>JUBAYER - Ultra Hosting Panel</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root {
            --bg-color: #000000;
            --primary: #00ffff;
            --accent: #00ffff;
            --box-bg: rgba(22, 27, 34, 0.7);
            --text-glow: rgba(0, 255, 204, 0.4);
            --font-head: 'Orbitron', sans-serif;
            --font-body: 'Rajdhani', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-color);
            color: #e6edf3;
            font-family: var(--font-body);
            min-height: 100vh;
            padding-bottom: 120px;
            overflow-x: hidden;
        }

        #particles-js { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }

        .user-bar { 
            background: rgba(0, 0, 0, 0.8); padding: 10px 15px; display: flex; 
            justify-content: space-between; align-items: center; backdrop-filter: blur(15px); 
            position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .container { width: 94%; max-width: 600px; margin: 0 auto; position: relative; z-index: 1; }

        .upload-card { 
            background: var(--box-bg); padding: 25px; border-radius: 20px; 
            border: 2px dashed rgba(0, 255, 255, 0.3); backdrop-filter: blur(12px); 
            margin-bottom: 20px; transition: 0.3s;
        }
        .upload-btn { background: var(--accent); color: #000; font-weight: 800; font-family: var(--font-head); border:none; border-radius:10px; padding: 14px; width: 100%; margin-top: 15px; cursor: pointer; text-transform: uppercase; }

        .box { background: var(--box-bg); padding: 18px; border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.08); margin-bottom: 20px; }
        
        /* স্ট্যাটাস বক্স স্টাইল */
        .status-badge {
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: bold;
            font-family: var(--font-head);
            display: inline-block;
            text-transform: uppercase;
        }
        .status-running { background: rgba(0, 255, 65, 0.15); color: #00ff41; border: 1px solid #00ff41; }
        .status-offline { background: rgba(255, 71, 87, 0.15); color: #ff4757; border: 1px solid #ff4757; }

        .runtime-container { margin: 10px 0 15px 0; padding: 10px; background: rgba(0, 255, 255, 0.05); border-radius: 12px; border: 1px solid rgba(0, 255, 255, 0.1); display: flex; align-items: center; justify-content: space-between; }
        .runtime-clock { font-family: var(--font-head); font-size: 12px; color: var(--accent); text-shadow: 0 0 5px var(--accent); }

        .button-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .btn-m { padding: 12px; border-radius: 10px; text-decoration: none; text-align: center; font-size: 13px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 5px; border: none; font-family: var(--font-body); }
        .run { background: #00d2ff; color: #000; }
        .stop { background: #ff4757; color: #fff; }
        .restart { background: #f39c12; color: #000; }
        .delete { background: #30363d; color: #ff4d4d; border: 1px solid #ff4d4d; }

        pre { background: #0d1117; color: #00ff41; padding: 12px; height: 130px; overflow-y: auto; border-radius: 12px; border: 1px solid #30363d; font-size: 11px; margin-top: 15px; }

        .branding { text-align: center; padding: 20px 0; }
        .jubayer-text { font-size: 1.6rem; font-weight: 900; font-family: var(--font-head); letter-spacing: 6px; background: linear-gradient(to bottom, #fff, var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .social-bar { 
            background: transparent; padding: 15px; position: fixed; 
            bottom: 20px; width: 100%; display: flex; justify-content: center; gap: 25px; border: none; z-index: 1001; 
        }
        .social-icon { color: white; font-size: 26px; transition: 0.3s; text-shadow: 0 0 10px rgba(0, 255, 255, 0.5); }
    </style>
</head>
<body>

<div id="particles-js"></div>

<div class="user-bar">
    <div style="font-family: var(--font-head); color: var(--accent); font-size: 13px;">MR.GHOST</div>
    <a href="/logout" style="color:#ff4d4d; font-size:18px;"><i class="fa-solid fa-power-off"></i></a>
</div>

<div class="container">
    <div class="upload-card">
        <form id="uploadForm" method="POST" action="/upload" enctype="multipart/form-data">
            <input type="file" name="file" id="fileInput" accept=".zip" required style="display:none;">
            <label for="fileInput" style="cursor:pointer; display:block; text-align: center;">
                <i class="fa-solid fa-cloud-arrow-up" style="font-size: 40px; color: var(--accent);"></i>
                <div style="margin-top:10px; font-weight: 600;">UPLOAD ZIP PROJECT</div>
            </label>
            <button type="submit" class="upload-btn">DEPLOY SERVER</button>
        </form>
    </div>

    {% for app in apps %}
    <div class="box">
        <div style="display:flex; justify-content:space-between; align-items: center; margin-bottom:15px; font-family: var(--font-head);">
            <span style="color: var(--accent);">{{ app.name }}</span>
            <span id="status-{{ app.name }}" class="status-badge {% if app.running %}status-running{% else %}status-offline{% endif %}">
                ● {% if app.running %}RUNNING{% else %}OFFLINE{% endif %}
            </span>
        </div>

        <div class="runtime-container">
            <span style="font-size: 11px; color: #8b949e;">UPTIME:</span>
            <span class="runtime-clock" id="timer-{{ app.name }}">00d 00h 00m 00s</span>
        </div>
        
        <div class="button-grid">
            <a href="/run/{{ app.name }}" class="btn-m run"><i class="fa-solid fa-play"></i> START</a>
            <a href="/stop/{{ app.name }}" class="btn-m stop"><i class="fa-solid fa-stop"></i> STOP</a>
            <a href="/restart/{{ app.name }}" class="btn-m restart"><i class="fa-solid fa-rotate"></i> RESTART</a>
            <button onclick="confirmDelete('{{ app.name }}', '/delete/{{ app.name }}')" class="btn-m delete"><i class="fa-solid fa-trash"></i> DELETE</button>
        </div>
        <pre id="log-{{ app.name }}">Logs will appear here...</pre>
    </div>
    {% endfor %}

    <div class="branding">
        <h1 class="jubayer-text">JUBAYER</h1>
        <p style="font-size: 11px; color: #8b949e; letter-spacing: 3px;">সাদিয়া শুধু আমার</p>
    </div>
</div>

<div class="social-bar">
    <a href="https://t.me/mr_ghost34" target="_blank" class="social-icon"><i class="fa-brands fa-telegram"></i></a>
    <a href="https://youtube.com/@mr.ghost-34" target="_blank" class="social-icon"><i class="fa-brands fa-youtube"></i></a>
    <a href="https://instagram.com/your_insta" target="_blank" class="social-icon"><i class="fa-brands fa-instagram"></i></a>
    <a href="https://tiktok.com/@your_tiktok" target="_blank" class="social-icon"><i class="fa-brands fa-tiktok"></i></a>
</div>

<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<script>
    let startTimes = {}; 

    particlesJS('particles-js', {
        "particles": {
            "number": { "value": 60 },
            "color": { "value": "#00ffff" },
            "line_linked": { "enable": true, "color": "#00ffff", "opacity": 0.2 },
            "move": { "enable": true, "speed": 3 }
        }
    });

    function updateSystem() {
        {% for app in apps %}
            fetch('/get_log/{{ app.name }}').then(res => res.json()).then(data => {
                const badge = document.getElementById('status-{{ app.name }}');
                const timerEl = document.getElementById('timer-{{ app.name }}');
                const logBox = document.getElementById('log-{{ app.name }}');
                
                if (data.log) logBox.innerText = data.log;

                if (data.status === "RUNNING") {
                    badge.innerText = "● RUNNING";
                    badge.className = "status-badge status-running";
                    if (data.start_time > 0) startTimes['{{ app.name }}'] = data.start_time;
                } else {
                    badge.innerText = "● OFFLINE";
                    badge.className = "status-badge status-offline";
                    timerEl.innerText = "00d 00h 00m 00s";
                    delete startTimes['{{ app.name }}'];
                }
            });
        {% endfor %}
    }

    function runTimers() {
        Object.keys(startTimes).forEach(name => {
            const diff = Date.now() - startTimes[name];
            if (diff > 0) {
                const d = Math.floor(diff / 86400000);
                const h = Math.floor((diff % 86400000) / 3600000);
                const m = Math.floor((diff % 3600000) / 60000);
                const s = Math.floor((diff % 60000) / 1000);
                document.getElementById(`timer-${name}`).innerText = 
                    `${String(d).padStart(2,'0')}d ${String(h).padStart(2,'0')}h ${String(m).padStart(2,'0')}m ${String(s).padStart(2,'0')}s`;
            }
        });
    }

    setInterval(updateSystem, 3000);
    setInterval(runTimers, 1000);

    function confirmDelete(name, url) {
        Swal.fire({ title: 'মুছে ফেলবেন?', text: `${name} মুছে ফেলা হবে!`, icon: 'warning', showCancelButton: true, confirmButtonColor: '#ff4d4d', background: '#0a0a0a', color: '#fff' })
        .then(res => { if(res.isConfirmed) window.location.href = url; });
    }
</script>
</body>
</html>
